<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    

    <title>
      如何安装并使用PANDA | gogolena 
    </title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    
      <meta name="author" content="blingbling">
    
    

    <meta name="description" content="[TOC] PANDA及其运行环境安装安装PANDA 首先，在GitHub上根据官方文档安装。地址：https://github.com/panda-re/panda123456789sudo add-apt-repository ppa:phulin/pandasudo apt-get updatesudo apt-get build-dep qemusudo apt-get install p">
<meta name="keywords" content="keywords_1,keywords_2,keywords_3">
<meta property="og:type" content="article">
<meta property="og:title" content="如何安装并使用PANDA | gogolena">
<meta property="og:url" content="http://yoursite.com/2018/04/27/如何安装并使用PANDA/index.html">
<meta property="og:site_name" content="gogolena">
<meta property="og:description" content="[TOC] PANDA及其运行环境安装安装PANDA 首先，在GitHub上根据官方文档安装。地址：https://github.com/panda-re/panda123456789sudo add-apt-repository ppa:phulin/pandasudo apt-get updatesudo apt-get build-dep qemusudo apt-get install p">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2018-04-27T01:56:31.419Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="如何安装并使用PANDA | gogolena">
<meta name="twitter:description" content="[TOC] PANDA及其运行环境安装安装PANDA 首先，在GitHub上根据官方文档安装。地址：https://github.com/panda-re/panda123456789sudo add-apt-repository ppa:phulin/pandasudo apt-get updatesudo apt-get build-dep qemusudo apt-get install p">
    
    
    
      <link rel="icon" type="image/x-icon" href="/favicon.png">
    
    <link rel="stylesheet" href="/css/uno.css">
    <link rel="stylesheet" href="/css/highlight.css">
    <link rel="stylesheet" href="/css/archive.css">
    <link rel="stylesheet" href="/css/china-social-icon.css">

</head>
<body>

    <span class="mobile btn-mobile-menu">
        <i class="icon icon-list btn-mobile-menu__icon"></i>
        <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

    

<header class="panel-cover panel-cover--collapsed">


  <div class="panel-main">

  
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        

        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage">gogolena</a></h1>
        <hr class="panel-cover__divider" />

        
        <p class="panel-cover__description">
          Look at the stars, look how they shine for you.
        </p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />
        

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">

              
                
                <li class="navigation__item"><a href="/#blog" title="" class="blog-button">首页</a></li>
              
                
                <li class="navigation__item"><a href="/about" title="" class="">关于</a></li>
              
                
                <li class="navigation__item"><a href="/archive" title="" class="">归档</a></li>
              

            </ul>
          </nav>

          <!-- ----------------------------
To add a new social icon simply duplicate one of the list items from below
and change the class in the <i> tag to match the desired social network
and then add your link to the <a>. Here is a full list of social network
classes that you can use:

    icon-social-500px
    icon-social-behance
    icon-social-delicious
    icon-social-designer-news
    icon-social-deviant-art
    icon-social-digg
    icon-social-dribbble
    icon-social-facebook
    icon-social-flickr
    icon-social-forrst
    icon-social-foursquare
    icon-social-github
    icon-social-google-plus
    icon-social-hi5
    icon-social-instagram
    icon-social-lastfm
    icon-social-linkedin
    icon-social-medium
    icon-social-myspace
    icon-social-path
    icon-social-pinterest
    icon-social-rdio
    icon-social-reddit
    icon-social-skype
    icon-social-spotify
    icon-social-stack-overflow
    icon-social-steam
    icon-social-stumbleupon
    icon-social-treehouse
    icon-social-tumblr
    icon-social-twitter
    icon-social-vimeo
    icon-social-xbox
    icon-social-yelp
    icon-social-youtube
    icon-social-zerply
    icon-mail

-------------------------------->

<!-- add social info here -->



        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner entry">
            

<article class="post-container post-container--single">

  <header class="post-header">
    
    <h1 class="post-title">如何安装并使用PANDA</h1>

    

    <div class="post-meta">
      <time datetime="2018-04-27" class="post-meta__date date">2018-04-27</time> 

      <span class="post-meta__tags tags">

          

          

      </span>
    </div>
    
    

  </header>

  <section id="post-content" class="article-content post">
    <p>[TOC]</p>
<h1 id="PANDA及其运行环境安装"><a href="#PANDA及其运行环境安装" class="headerlink" title="PANDA及其运行环境安装"></a>PANDA及其运行环境安装</h1><h2 id="安装PANDA"><a href="#安装PANDA" class="headerlink" title="安装PANDA"></a>安装PANDA</h2><ul>
<li>首先，在GitHub上根据官方文档安装。地址：<a href="https://github.com/panda-re/panda" target="_blank" rel="noopener">https://github.com/panda-re/panda</a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:phulin/panda</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get build-dep qemu</span><br><span class="line">sudo apt-get install python-pip git protobuf-compiler protobuf-c-compiler \</span><br><span class="line">  libprotobuf-c0-dev libprotoc-dev python-protobuf libelf-dev \</span><br><span class="line">  libcapstone-dev libdwarf-dev python-pycparser llvm-3.3 clang-3.3 libc++-dev</span><br><span class="line">git clone https://github.com/panda-re/panda</span><br><span class="line">mkdir -p build-panda &amp;&amp; cd build-panda</span><br><span class="line">../panda/build.sh</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>安装代码就是这一小段，选用的主机操作系统是Ubuntu 14.04。</p>
<h2 id="安装QEMU"><a href="#安装QEMU" class="headerlink" title="安装QEMU"></a>安装QEMU</h2><ul>
<li>在官网下载qemu2.8。</li>
<li><p>拷贝到某个目录下进行解压缩</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -Jxvf 源文件 -C 目标文件夹 </span><br><span class="line">如：tar -Jxvf qemu-2.8.1.1.tar.xz -C /home/yuan</span><br></pre></td></tr></table></figure>
</li>
<li><p>在~目录下新建一个build-qemu文件夹，转到该文件夹进行qemu的configure。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">mkdir -p build-qemu &amp;&amp; cd build-qemu</span><br><span class="line">../qemu/configure --enalbe-debug</span><br></pre></td></tr></table></figure>
</li>
<li><p>然后再make一下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make -j4        //电脑是四核的，所以-j4，运行起来更快</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="QEMU中安装win7操作系统"><a href="#QEMU中安装win7操作系统" class="headerlink" title="QEMU中安装win7操作系统"></a>QEMU中安装win7操作系统</h2><ul>
<li><p>首先，在~目录下创建一个image文件夹，然后创建一个win7.qcow2文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">mkdir -p image</span><br><span class="line">cd image</span><br><span class="line">qemu-img create -f qcow2 win7.qcow2 8G</span><br></pre></td></tr></table></figure>
</li>
<li><p>然后将win7的镜像文件拷贝到win7.qcow2所在目录下。</p>
</li>
<li>转到/home/yuan/build-qemu/i386-softmmu目录下执行<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./qemu-system-i386 -m 512 -hda /home/yuan/IMG/win7.qcow2 -cdrom /home/yuan/IMG/win7.iso -boot d -enable-kvm</span><br><span class="line">（如果需要鼠标控制则加上 -usbdevice tablet ，如果要加速则加上-enable-kvm）</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="遇到的小问题"><a href="#遇到的小问题" class="headerlink" title="遇到的小问题"></a>遇到的小问题</h3><p>一开始显示我电脑不支持kvm，于是上网搜罗了一大堆原因，如下：</p>
<p>How to fix error ‘Could not access KVM kernel module’ in Proxmox, Virtualizor, SolusVM, Redhat, CentOS and Ubuntu：</p>
<p><a href="https://bobcares.com/blog/how-to-fix-error-could-not-access-kvm-kernel-module/" target="_blank" rel="noopener">https://bobcares.com/blog/how-to-fix-error-could-not-access-kvm-kernel-module/</a></p>
<p>查看是否可虚拟化：</p>
<p><a href="http://www.linuxidc.com/Linux/2012-09/69714.htm" target="_blank" rel="noopener">http://www.linuxidc.com/Linux/2012-09/69714.htm</a></p>
<p>最后才发现原来是这个原因，就因为这么一个低级错误竟然害我折腾了一晚上的时间。。。</p>
<p><a href="http://yang19890314.blog.51cto.com/1620466/1136803" target="_blank" rel="noopener">http://yang19890314.blog.51cto.com/1620466/1136803</a></p>
<h2 id="运行小测试"><a href="#运行小测试" class="headerlink" title="运行小测试"></a>运行小测试</h2><ul>
<li><p>在PANDA中启动qemu</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /home/yuan/build-panda/i386-softmmu</span><br><span class="line">./qemu-system-i386 -m 512 -hda /home/yuan/IMG/win7.qcow2 -monitor stdio -usbdevice tablet</span><br><span class="line">或者</span><br><span class="line">./qemu-system-i386 –m 1024 –os windows-32-7 –drive file=/home/bling/image/win7.qcow2 –monitor stdio</span><br></pre></td></tr></table></figure>
</li>
<li><p>在qemu中启动虚拟机</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /home/yuan/build-qemu/i386-softmmu</span><br><span class="line">./qemu-system-i386 -m 512 -hda /home/yuan/IMG/win7.qcow2 -enable-kvm -monitor stdio -usbdevice tablet</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="安装vsftp来传输文件至qemu虚拟机"><a href="#安装vsftp来传输文件至qemu虚拟机" class="headerlink" title="安装vsftp来传输文件至qemu虚拟机"></a>安装vsftp来传输文件至qemu虚拟机</h2><ul>
<li><p>执行如下命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install vsftpd</span><br><span class="line">sudo gedit /etc/vsftpd.conf</span><br></pre></td></tr></table></figure>
</li>
<li><p>更改vsftpd.conf中的dir项，改成本机中的某个文件夹，用来传输文件给qemu中的win7虚拟机。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secure chroot dir=/home/yuan/ftpShare</span><br></pre></td></tr></table></figure>
</li>
<li><p>ifconfig一下，查看ip地址。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ifconfig</span><br><span class="line">(eth0   inet addr:192.168.43.19)</span><br><span class="line">(lo     inet addr:127.0.0.1)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>然后配置相应参数。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo service vsftpd restart</span><br><span class="line">ftp 127.0.0.1</span><br><span class="line">(name:  )</span><br><span class="line">(Password:  )</span><br><span class="line">quit</span><br></pre></td></tr></table></figure></p>
<ul>
<li>配置完成后，打开qemu模拟器，在IE浏览器中输入<a href="ftp://192.168.43.19/，然后输入上面设置的用户名和密码，即可访问Ubuntu主机中ftpShare目录下的文件了。" target="_blank" rel="noopener">ftp://192.168.43.19/，然后输入上面设置的用户名和密码，即可访问Ubuntu主机中ftpShare目录下的文件了。</a></li>
</ul>
<h1 id="使用PANDA"><a href="#使用PANDA" class="headerlink" title="使用PANDA"></a>使用PANDA</h1><h2 id="在PANDA中打开qemu模拟器"><a href="#在PANDA中打开qemu模拟器" class="headerlink" title="在PANDA中打开qemu模拟器"></a>在PANDA中打开qemu模拟器</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /home/yuan/build-panda/i386-softmmu</span><br><span class="line">./qemu-system-i386 /home/yuan/image/win7.qcow2 -m 1024 -monitor stdio -usbdevice tablet</span><br><span class="line">或者</span><br><span class="line">./qemu-system-i386 -hda /home/yuan/image/win7.qcow2 -m 1024 -monitor stdio -usbdevice tablet</span><br><span class="line">或者</span><br></pre></td></tr></table></figure>
<p>记录重放文件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">begin_record xxx        //选择一个点开始拍摄快照，记录</span><br><span class="line">end_record          //结束记录</span><br><span class="line">quit</span><br></pre></td></tr></table></figure></p>
<p>运行重放文件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./qemu-system-i386 -replay itry -hda /home/kumquat_cc/IMG/win7.qcow2 -m 512 -monitor stdio -usbdevice tablet</span><br><span class="line">或者</span><br></pre></td></tr></table></figure></p>
<h1 id="使用scissors插件"><a href="#使用scissors插件" class="headerlink" title="使用scissors插件"></a>使用scissors插件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./qemu-system-i386 -m 512 -hda /home/kumquat_cc/IMG/win7.qcow2 -monitor stdio -usbdevice tablet -replay itry -panda scissors:name=cutstart,start=39410248,end=72252110</span><br><span class="line">或者</span><br></pre></td></tr></table></figure>
<h1 id="使用test插件"><a href="#使用test插件" class="headerlink" title="使用test插件"></a>使用test插件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
  </section>

  <section class="post-comments">

    <!-- 将评论系统（例如Disqus、多说、友言、畅言等）提供的代码片段粘贴在这里 -->
    
</section>


</article>


            <footer class="footer">

    <span class="footer__copyright">&copy; 2014-2015. | 由<a href="https://hexo.io/">Hexo</a>强力驱动 | 主题<a href="https://github.com/someus/huno">Huno</a></span>
    
</footer>
        </div>
    </div>

    <!-- js files -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/scale.fix.js"></script>
    

    

    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript"> 
        $(document).ready(function(){
            MathJax.Hub.Config({ 
                tex2jax: {inlineMath: [['[latex]','[/latex]'], ['\\(','\\)']]} 
            });
        });
    </script>


    

    <script src="/js/awesome-toc.min.js"></script>
    <script>
        $(document).ready(function(){
            $.awesome_toc({
                overlay: true,
                contentId: "post-content",
            });
        });
    </script>


    
    
    <!--kill ie6 -->
<!--[if IE 6]>
  <script src="//letskillie6.googlecode.com/svn/trunk/2/zh_CN.js"></script>
<![endif]-->

</body>
</html>
